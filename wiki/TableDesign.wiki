#summary Table Design

== テーブル設計 ==

テーブル設計の議論は Issue 27 を参照

=== タスクマスタ ===
====[概要]====
作業タスクを登録する

基本的に入力する時のドロップダウンリストに表示するためのテーブルなので、10個程度を残してどんどん削除される想定

*テーブル名* tasks
|| *物理名*    || *項目名*   || *タイプなど*                      ||
|| {{{_id}}}   || ID         || INTEGER PRIMARY KEY AUTOINCREMENT ||
|| code        || 作業コード || TEXT                              ||
|| description || 作業内容   || TEXT                              ||

=== 勤務実績 ===
==== [概要] ====
一日の作業時間を記録する

開始ボタンを押した時にレコードが作成され、終了ボタンで終了日時をセットする

アプリケーションが中断(あるいは終了)して、再開する場合は続きから再開する。終了日時が null 値のものが現在記録中のレコード

終了ボタンが押されるまで、ずっと仕事をしていることになるので、押し忘れた場合の対応は別に考える

*テーブル名* works
|| *物理名*    || *項目名*   || *タイプなど*                      ||
|| {{{_id}}}   || ID         || INTEGER PRIMARY KEY AUTOINCREMENT ||
|| start       || 勤務開始日時   || INTEGER                           ||
|| end         || 勤務終了日時   || INTEGER                           ||

SQLite3 はには日付タイプがないので、UNIX time で日時を記録するものとする


=== タスク実績 ===
==== [概要] ====
各タスクの実行を記録する

タスクの開始時刻だけを記録して、別のタスクが開始したらそれが今のタスクの終了と見なす。

タスクの実績は、勤務実績と紐付けられ、1日の仕事の明細を形成する

各レコードは作成されるだけ、更新されない

各タスクにはタスクコードとタスク名がマスターとは別途記録される。マスターには直近のタスク10個程度が登録されているが、タスク実績には過去分がずっと残される。

*テーブル名* affairs
|| *物理名*    || *項目名*   || *タイプなど*                      ||
|| {{{_id}}}   || ID         || INTEGER PRIMARY KEY AUTOINCREMENT ||
|| work_id     || 勤務ID     || INTEGER (FOREIGN KEY)             ||
|| start       || 作業開始日時 || INTEGER                         ||
|| code        || 作業コード || TEXT                              ||
|| description || 作業内容   || TEXT                              ||

=== 例 ===

tasks
||{{{_id}}}|| code || description||
||    1    || A001 || ○○業務 打ち合わせ ||
||    2    || A002 || ○○業務 基本設計 ||
||    3    || B001 || ××業務 品質レビュー ||
||    4    || Z001 || 休憩 ||

works
||{{{_id}}}|| start               || end ||
||    1    || 2011/12/05 09:00:00 || 2011/12/05 19:00:00 ||
||    2    || 2011/12/06 10:00:00 || null ||

affairs
||{{{_id}}}|| work_id || start               || code || description ||
||    1    ||   1     || 2011/12/05 09:00:00 || A003 || ○○業務 要件定義 ||
||    2    ||   1     || 2011/12/05 12:00:00 || Z001 || 休憩 ||
||    3    ||   1     || 2011/12/05 13:00:00 || B001 || ××業務 品質レビュー ||
||    4    ||   1     || 2011/12/05 15:00:00 || C001 || △△業務 打ち合わせ ||
||    5    ||   1     || 2011/12/05 17:00:00 || A003 || ○○業務 要件定義 ||
||    6    ||   2     || 2011/12/06 10:00:00 || A001 || ○○業務 打ち合わせ ||
||    7    ||   2     || 2011/12/06 12:00:00 || Z001 || 休憩 (ここから再開) ||

